{"version":3,"sources":["field/multi-uploader-field.js"],"names":["window","MultiUploader","Vue","extend","name","mounted","$","$el","data","$options","metaModal","find","trigger","updated","methods","openFile","item","openFileHandler","open","download_url","url","itemClick","i","event","current","currentIndex","modal","metaSave","isImage","ext","split","pop","shift","allow","indexOf","dragover","e","canReUpload","$refs","dragarea","style","opacity","dragleave","drop","file","dataTransfer","files","app","checkFile","canUpload","reader","FileReader","itemComponent","key","loading","upload","always","watch","value"],"mappings":"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","sourcesContent":["/**\n * Part of earth project.\n *\n * @copyright  Copyright (C) 2020 .\n * @license    __LICENSE__\n */\n\nwindow.MultiUploader = Vue.extend({\n  name: 'multi-uploader',\n  mounted() {\n    $(this.$el).data('multi-uploader', this);\n\n    this.$options.metaModal = $(this.$el).find('.c-multi-uploader-modal');\n\n    $(this.$el).trigger('multi-uploader:mounted');\n  },\n  updated() {\n\n  },\n  methods: {\n    openFile(item) {\n      if (this.$options.openFileHandler) {\n        this.$options.openFileHandler(item);\n      } else {\n        window.open(item.download_url || item.url);\n      }\n    },\n\n    itemClick(item, i, event) {\n      this.current = item;\n      this.currentIndex = i;\n\n      this.$options.metaModal.modal('show');\n    },\n\n    metaSave() {\n      this.current = {};\n      this.currentIndex = null;\n\n      this.$options.metaModal.modal('hide');\n    },\n\n    isImage(url) {\n      const ext = url.split('.').pop().split('?').shift();\n\n      const allow = [\n        'png',\n        'jpeg',\n        'jpg',\n        'gif',\n        'bmp',\n        'webp',\n      ];\n\n      return allow.indexOf(ext) !== -1;\n    },\n\n    dragover(e) {\n      if (!this.canReUpload) {\n        return;\n      }\n\n      this.$refs.dragarea.style.opacity = 0.75;\n    },\n\n    dragleave(e) {\n      if (!this.canReUpload) {\n        return;\n      }\n\n      this.$refs.dragarea.style.opacity = 1;\n    },\n\n    drop(event) {\n      if (!this.canReUpload) {\n        return;\n      }\n\n      this.$refs.dragarea.style.opacity = 1;\n\n      const item = this.current;\n      const file = event.dataTransfer.files[0];\n\n      this.$refs.app.checkFile(file);\n\n      if (!this.$refs.app.canUpload) {\n        return;\n      }\n\n      const reader = new FileReader();\n      item.file = file;\n      const itemComponent = this.$refs.app.$refs[item.key][0];\n\n      this.loading = true;\n      this.$refs.app.$refs[item.key][0].upload()\n        .always(() => {\n          this.loading = false;\n        });\n    },\n  },\n  watch: {\n    value() {\n    }\n  }\n});\n"],"file":"multi-uploader-field.js"}