{"version":3,"sources":["vue/vue-drag-uploader.js"],"names":["itemStates","NEW","UPLOADING","COMPLETED","FAIL","STOP","VueDragUploaderItem","template","data","state","progress","messages","error","props","item","Object","i","Number","initState","String","uploadUrl","created","mounted","upload","methods","uniqid","Date","valueOf","formData","FormData","append","file","$emit","$","post","url","contentType","processData","xhr","XMLHttpRequest","addEventListener","e","lengthComputable","loaded","total","done","res","thumb_url","fail","console","warn","responseJSON","message","always","deleteSelf","watch","VueDragUploader","components","items","uploadQueue","images","Array","maxFiles","placeholder","map","image","key","getKey","uploadState","length","splice","$el","event","stopPropagation","preventDefault","currentTarget","classList","add","remove","files","target","dataTransfer","uploadFiles","clickAdd","$input","document","createElement","setAttribute","dispatchEvent","MouseEvent","window","date","getTime","getMilliseconds","Math","random","prototype","forEach","call","checkFile","canUpload","reader","FileReader","id","title","alt","description","push","onload","result","readAsDataURL","types","indexOf","type","deleteItem","child","filter","uploadStart","Vue","set","uploadEnd","delete","uploadProgress","itemClick","$event","handler","deep","uploading","val","computed","keys","component"],"mappings":"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","sourcesContent":["/**\n * Part of ke project.\n *\n * @copyright  Copyright (C) 2018 ${ORGANIZATION}.\n * @license    __LICENSE__\n */\n\n(() => {\n  const itemStates = {\n    NEW: 'new',\n    UPLOADING: 'uploading',\n    COMPLETED: 'completed',\n    FAIL: 'fail',\n    STOP: 'stop',\n  };\n\n  const VueDragUploaderItem = {\n    template: `\n<div class=\"vue-drag-uploader__item preview-img\"\n    @click=\"$emit('click', item, i, $event)\">\n    <slot name=\"item\" :item=\"item\">\n        <div class=\"preview-img__body\"\n            :style=\"{'background-image': 'url(' + (item.thumb_url || item.url) + ')'}\"></div>\n\n        <div class=\"preview-img__overlay\">\n          <span class=\"preview-img__remove-icon fa fa-times\"\n              @click.stop.prevent=\"deleteSelf()\"></span>\n          <slot name=\"extra\" :item=\"item\"></slot>\n        </div>\n\n        <div class=\"preview-img__progress\" v-if=\"state === 'uploading'\">\n            <div class=\"preview-img__progress-bar\"\n                :style=\"{width: (progress * 100) + '%'}\"\n            ></div>\n        </div>\n        <div class=\"preview-img__error-message error-message\" v-if=\"state === 'fail'\" @click.stop.prevent=\"\">\n            <span class=\"error-message__notice\">Upload fail</span>\n            <span class=\"error-message__message\">{{ messages.error }}</span>\n        </div>\n    </slot>\n</div>\n    `,\n    data() {\n      return {\n        state: itemStates.COMPLETED,\n        progress: 0,\n        messages: {\n          error: ''\n        }\n      }\n    },\n    props: {\n      item: Object,\n      i: Number,\n      initState: String,\n      uploadUrl: String\n    },\n    created() {\n      this.state = this.initState;\n\n      if (this.initState === itemStates.NEW) {\n\n      }\n    },\n    mounted() {\n      if (this.initState === itemStates.NEW) {\n        this.upload();\n      }\n    },\n    methods: {\n      upload() {\n        this.state = itemStates.UPLOADING;\n\n        const uniqid = new Date().valueOf();\n        const formData = new FormData();\n        formData.append('file', this.item.file);\n\n        this.$emit('upload-start', uniqid);\n\n        return $.post({\n            url: this.uploadUrl,\n            data: formData,\n            contentType: false,\n            processData: false,\n            xhr: () => {\n              const xhr = new XMLHttpRequest();\n\n              if(xhr.upload){\n                xhr.upload.addEventListener('progress', e => {\n                  if (e.lengthComputable) {\n                    this.progress = e.loaded / e.total;\n                    this.$emit('upload-progress', uniqid, this.progress);\n                  }\n                }, false);\n              }\n\n              return xhr;\n            },\n        })\n          .done(res => {\n            this.state = itemStates.COMPLETED;\n            this.item.url = res.data.url;\n            this.item.thumb_url = res.data.thumb_url || res.data.url;\n          })\n          .fail(xhr => {\n            console.warn(xhr.responseJSON.message, xhr);\n            this.state = itemStates.FAIL;\n            this.messages.error = xhr.responseJSON.message;\n          })\n          .always(() => {\n            this.item.file = null;\n\n            this.$emit('upload-end', uniqid);\n          });\n      },\n\n      deleteSelf() {\n        this.$emit('delete', this.item);\n      }\n    },\n    watch: {\n    }\n  };\n\n  const VueDragUploader = {\n    components: {\n      'vue-drag-uploader-item': VueDragUploaderItem\n    },\n    template: `\n<div class=\"vue-drag-uploader\">\n    <div class=\"vue-drag-uploader__wrapper\">\n        <slot name=\"items\" \n            :items=\"items\"\n            :url=\"url\"\n            :max-files=\"maxFiles\"\n            :files-limited=\"maxFiles\"\n        >\n            <draggable v-model=\"items\" class=\"vue-drag-uploader__draggable-wrapper\" \n                :options=\"{draggable: '.preview-img', animation: 300}\">\n                <slot name=\"items\" :item=\"items\">\n                    <vue-drag-uploader-item\n                        v-for=\"(item, i) of items\"\n                        :item=\"item\"\n                        :i=\"i\"\n                        :init-state=\"item.uploadState\"\n                        :key=\"item.key\"\n                        :upload-url=\"url\"\n                        @delete=\"deleteItem\"\n                        @upload-start=\"uploadStart\"\n                        @upload-end=\"uploadEnd\"\n                        @upload-progress=\"uploadProgress\"\n                        @click=\"itemClick\"\n                        >\n                        <template slot=\"item\">\n                            <slot name=\"item\" \n                                :item=\"item\" \n                                :i=\"i\" \n                                :url=\"url\"\n                                :max-files=\"maxFiles\"\n                                :files-limited=\"maxFiles\"></slot>\n                        </template>\n                        <template slot=\"extra\">\n                            <slot name=\"extra\" \n                                :item=\"item\" \n                                :i=\"i\" \n                                :url=\"url\"\n                                :max-files=\"maxFiles\"\n                                :files-limited=\"maxFiles\"></slot>\n                        </template>\n                    </vue-drag-uploader-item>\n                </slot>\n                \n                <div v-if=\"canUpload\" class=\"vue-drag-uploader__item add-button\" :key=\"'empty'\"\n                    @click=\"clickAdd()\">\n                    <div class=\"add-button__body\">\n                        <div class=\"add-button__icon\">\n                            <span class=\"fa fa-upload fa-2x\"></span>\n                        </div>\n                        <div class=\"add-button__text\">\n                            {{ placeholder }}\n                        </div>\n                    </div>\n                </div>\n            </draggable>\n        </slot>\n    </div>\n</div>\n    `,\n    data() {\n      return {\n        items: [],\n        uploadQueue: {}\n      }\n    },\n    props: {\n      url: String,\n      images: Array,\n      maxFiles: [String, Number],\n      placeholder: String\n    },\n    created() {\n      this.images.map(image => {\n        image.key = image.key || this.getKey();\n        image.uploadState = itemStates.COMPLETED;\n      });\n\n      this.items = this.images;\n\n      if (this.maxFiles != null) {\n        if (this.maxFiles < this.items.length) {\n          this.items.splice(this.maxFiles);\n        }\n      }\n    },\n    mounted() {\n      this.$el.addEventListener('dragover', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.add('vue-drag-uploader--ondrag');\n      });\n\n      this.$el.addEventListener('dragleave', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.remove('vue-drag-uploader--ondrag');\n      });\n\n      // File drop\n      this.$el.addEventListener(\"drop\", event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.remove('vue-drag-uploader--ondrag');\n\n        const files = event.target.files || event.dataTransfer.files;\n\n        this.uploadFiles(files);\n      });\n    },\n    methods: {\n      clickAdd() {\n        const $input = document.createElement(\"INPUT\");\n        $input.setAttribute('type', 'file');\n\n        $input.addEventListener('change', event => {\n          const files = event.target.files || event.dataTransfer.files;\n\n          this.uploadFiles(files);\n        });\n\n        $input.dispatchEvent(new MouseEvent('click', {\n          'view': window,\n          'bubbles': true,\n          'cancelable': true\n        }));\n      },\n\n      getKey() {\n        const date = new Date();\n\n        return date.getTime() + '.' + date.getMilliseconds() + '.' + Math.random();\n      },\n\n      uploadFiles(files) {\n        Array.prototype.forEach.call(files, file => {\n          if (!this.checkFile(file)) {\n            return;\n          }\n\n          if (!this.canUpload) {\n            return;\n          }\n\n          const reader = new FileReader;\n          const url = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n          const item = {\n            id: '',\n            key: this.getKey(),\n            url: '',\n            thumb_url: url,\n            uploadState: itemStates.NEW,\n            file: file,\n            title: '',\n            alt: '',\n            description: ''\n          };\n\n          this.items.push(item);\n\n          reader.onload = (event) => {\n            const url = event.target.result;\n\n            item.thumb_url = url;\n          };\n\n          reader.readAsDataURL(file);\n        });\n      },\n\n      checkFile: function(file) {\n        const types = [\n          'image/jpeg',\n          'image/png',\n          'image/gif'\n        ];\n\n        return types.indexOf(file.type) !== -1;\n      },\n\n      deleteItem(child) {\n        this.$emit('delete-item', child);\n\n        this.items = this.items.filter(item => item.key !== child.key);\n      },\n\n      uploadStart(uniqid) {\n        Vue.set(this.uploadQueue, uniqid, 0);\n      },\n\n      uploadEnd(uniqid) {\n        Vue.delete(this.uploadQueue, uniqid);\n      },\n\n      uploadProgress(uniqid, progress) {\n        this.uploadQueue[uniqid] = progress;\n      },\n\n      itemClick(item, i, $event) {\n        this.$emit('item-click', item, i, $event);\n      }\n    },\n    watch: {\n      images(images) {\n        images.map(image => {\n          image.key = image.key || this.getKey();\n        });\n\n        this.items = images;\n      },\n\n      items: {\n        handler(items) {\n          this.$emit('change', items);\n        },\n        deep: true\n      },\n\n      uploading(val) {\n        if (val) {\n          this.$emit('uploading');\n        } else {\n          this.$emit('uploaded');\n        }\n      }\n    },\n    computed: {\n      canUpload() {\n        return this.maxFiles == null || this.items.length < this.maxFiles;\n      },\n\n      uploading() {\n        Object.keys(this.uploadQueue);\n        return Object.keys(this.uploadQueue).length > 0;\n      }\n    }\n  };\n\n  Vue.component('vue-drag-uploader', VueDragUploader);\n})();\n"],"file":"vue-drag-uploader.js"}