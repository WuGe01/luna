{"version":3,"sources":["vue/vue-drag-uploader.js"],"names":["swal","$","window","title","message","alert","itemStates","NEW","UPLOADING","COMPLETED","FAIL","STOP","VueDragUploaderItem","template","data","state","progress","messages","error","props","item","Object","i","Number","initState","String","uploadUrl","size","created","mounted","upload","methods","uniqid","Date","valueOf","formData","FormData","append","file","name","$emit","post","url","contentType","processData","xhr","XMLHttpRequest","addEventListener","e","lengthComputable","loaded","total","done","res","isImage","thumb_url","fail","console","warn","responseJSON","always","deleteSelf","watch","computed","fileName","split","pop","ext","allow","indexOf","icon","icons","pdf","xls","xlsx","doc","docx","ppt","pptx","zip","rar","mp4","avi","flv","mov","ogg","webm","mpg","mp3","acc","wav","toLowerCase","VueDragUploader","components","items","uploadQueue","value","Array","maxFiles","thumbSize","placeholder","accept","type","map","key","getKey","uploadState","length","splice","$el","event","stopPropagation","preventDefault","currentTarget","classList","add","remove","files","target","dataTransfer","uploadFiles","clickAdd","$input","document","createElement","setAttribute","dispatchEvent","MouseEvent","date","getTime","getMilliseconds","Math","random","prototype","forEach","call","checkFile","canUpload","reader","FileReader","id","alt","description","push","onload","result","readAsDataURL","accepted","acceptedTypes","fileExt","compareMimeType","Phoenix","__","join","Error","mime","accepted2","mime2","deleteItem","child","filter","uploadStart","Vue","set","uploadEnd","uploadProgress","itemClick","$event","val","handler","deep","uploading","keys","isArray","v","trim","substr","component"],"mappings":"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","sourcesContent":["/**\n * Part of ke project.\n *\n * @copyright  Copyright (C) 2018 ${ORGANIZATION}.\n * @license    __LICENSE__\n */\n\n(() => {\n  let swal;\n\n  $(() => {\n    // Polyfill sweetalert\n    swal = window.swal || function swal(title, message = null) {\n      alert(title + ' / ' + message);\n    };\n  });\n\n  const itemStates = {\n    NEW: 'new',\n    UPLOADING: 'uploading',\n    COMPLETED: 'completed',\n    FAIL: 'fail',\n    STOP: 'stop',\n  };\n\n  const VueDragUploaderItem = {\n    template: `<div class=\"vue-drag-uploader__item preview-img\"\n    :style=\"{ width: size ? size + 'px' : null, height: size ? size + 'px' : null }\"\n    @click=\"$emit('click', item, i, $event)\">\n    <slot name=\"item\" :item=\"item\">\n        <div v-if=\"isImage\" class=\"preview-img__body\"\n            :style=\"{'background-image': 'url(' + (item.thumb_url || item.url) + ')'}\"></div>\n\n        <div v-if=\"!isImage\" class=\"preview-img__body d-flex justify-content-center align-items-center\">\n            <div class=\"text-center\">\n                <div>\n                    <span :class=\"icon\" class=\"fa-3x\"></span>\n                </div>\n                <div style=\"word-break: break-word\">{{ fileName }}</div>\n            </div>\n        </div>\n\n        <div class=\"preview-img__overlay\">\n          <span class=\"preview-img__remove-icon fa fa-times\"\n              @click.stop.prevent=\"deleteSelf()\"></span>\n            <slot name=\"extra\" :item=\"item\"></slot>\n        </div>\n\n        <div class=\"preview-img__progress\" v-if=\"state === 'uploading'\">\n            <div class=\"preview-img__progress-bar\"\n                :style=\"{width: (progress * 100) + '%'}\"\n            ></div>\n        </div>\n        <div class=\"preview-img__error-message error-message\" v-if=\"state === 'fail'\" @click.stop.prevent=\"\">\n            <span class=\"error-message__notice\">Upload fail</span>\n            <span class=\"error-message__message\">{{ messages.error }}</span>\n        </div>\n    </slot>\n</div>\n    `,\n    data() {\n      return {\n        state: itemStates.COMPLETED,\n        progress: 0,\n        messages: {\n          error: ''\n        }\n      };\n    },\n    props: {\n      item: Object,\n      i: Number,\n      initState: String,\n      uploadUrl: String,\n      size: Number\n    },\n    created() {\n      this.state = this.initState;\n\n      if (this.initState === itemStates.NEW) {\n\n      }\n    },\n    mounted() {\n      if (this.initState === itemStates.NEW) {\n        this.upload();\n      }\n    },\n    methods: {\n      upload() {\n        this.state = itemStates.UPLOADING;\n\n        const uniqid = new Date().valueOf();\n        const formData = new FormData();\n        formData.append('file', this.item.file);\n\n        this.item.title = this.item.file.name;\n\n        this.$emit('upload-start', uniqid);\n\n        return $.post({\n            url: this.uploadUrl,\n            data: formData,\n            contentType: false,\n            processData: false,\n            xhr: () => {\n              const xhr = new XMLHttpRequest();\n\n              if (xhr.upload) {\n                xhr.upload.addEventListener('progress', e => {\n                  if (e.lengthComputable) {\n                    this.progress = e.loaded / e.total;\n                    this.$emit('upload-progress', uniqid, this.progress);\n                  }\n                }, false);\n              }\n\n              return xhr;\n            },\n          })\n          .done(res => {\n            this.state = itemStates.COMPLETED;\n            this.item.url = res.data.url;\n\n            if (this.isImage) {\n              this.item.thumb_url = res.data.thumb_url || res.data.url;\n            }\n          })\n          .fail(xhr => {\n            console.warn(xhr.responseJSON.message, xhr);\n            this.state = itemStates.FAIL;\n            this.messages.error = xhr.responseJSON.message;\n          })\n          .always(() => {\n            this.item.file = null;\n\n            this.$emit('upload-end', uniqid);\n          });\n      },\n\n      deleteSelf() {\n        this.$emit('delete', this.item);\n      },\n    },\n    watch: {},\n    computed: {\n      fileName() {\n        if (this.item.file) {\n          return this.item.file.name;\n        } else if (this.item.title) {\n          return this.item.title;\n        } else {\n          return this.item.url.split('/').pop();\n        }\n      },\n\n      isImage() {\n        const ext = this.item.file\n          ? this.item.file.name.split('.').pop()\n          : this.item.url.split('.').pop();\n\n        const allow = [\n          'png',\n          'jpeg',\n          'jpg',\n          'gif',\n          'bmp',\n          'webp',\n        ];\n\n        return allow.indexOf(ext) !== -1;\n      },\n\n      icon() {\n        const ext = this.item.file\n          ? this.item.file.name.split('.').pop()\n          : this.item.url.split('.').pop();\n\n        const icons = {\n          pdf: 'fas fa-file-pdf text-danger',\n          xls: 'fas fa-file-excel text-success',\n          xlsx: 'fas fa-file-excel text-success',\n          doc: 'fas fa-file-word text-primary',\n          docx: 'fas fa-file-word text-primary',\n          ppt: 'fas fa-file-powerpoint text-warning',\n          pptx: 'fas fa-file-powerpoint text-warning',\n          zip: 'fas fa-file-archive text-dark',\n          '7z': 'fas fa-file-archive text-dark',\n          rar: 'fas fa-file-archive text-dark',\n          mp4: 'fas fa-file-video text-dark',\n          avi: 'fas fa-file-video text-dark',\n          flv: 'fas fa-file-video text-dark',\n          mov: 'fas fa-file-video text-dark',\n          ogg: 'fas fa-file-video text-dark',\n          webm: 'fas fa-file-video text-dark',\n          mpg: 'fas fa-file-video text-dark',\n          mp3: 'fas fa-file-audio text-dark',\n          acc: 'fas fa-file-audio text-dark',\n          wav: 'fas fa-file-audio text-dark',\n        };\n\n        return icons[ext.toLowerCase()] || 'fas fa-file';\n      }\n    }\n  };\n\n  const VueDragUploader = {\n    components: {\n      'vue-drag-uploader-item': VueDragUploaderItem\n    },\n    template: `\n<div class=\"vue-drag-uploader\">\n    <div class=\"vue-drag-uploader__wrapper\">\n        <slot name=\"items\" \n            :items=\"items\"\n            :url=\"url\"\n            :max-files=\"maxFiles\"\n            :files-limited=\"maxFiles\"\n        >\n            <draggable v-model=\"items\" class=\"vue-drag-uploader__draggable-wrapper\" \n                :options=\"{draggable: '.preview-img', animation: 300}\">\n                <slot name=\"items\" :item=\"items\">\n                    <vue-drag-uploader-item\n                        v-for=\"(item, i) of items\"\n                        :item=\"item\"\n                        :i=\"i\"\n                        :init-state=\"item.uploadState\"\n                        :key=\"item.key\"\n                        :upload-url=\"url\"\n                        :size=\"thumbSize\"\n                        @delete=\"deleteItem\"\n                        @upload-start=\"uploadStart\"\n                        @upload-end=\"uploadEnd\"\n                        @upload-progress=\"uploadProgress\"\n                        @click=\"itemClick\"\n                        >\n                        <template slot=\"item\">\n                            <slot name=\"item\" \n                                :item=\"item\"\n                                :i=\"i\" \n                                :url=\"url\"\n                                :max-files=\"maxFiles\"\n                                :thumb-size=\"thumbSize\"\n                                :files-limited=\"maxFiles\"></slot>\n                        </template>\n                        <template slot=\"extra\">\n                            <slot name=\"extra\"\n                                :item=\"item\" \n                                :i=\"i\" \n                                :url=\"url\"\n                                :max-files=\"maxFiles\"\n                                :thumb-size=\"thumbSize\"\n                                :files-limited=\"maxFiles\">\n                            </slot>\n                        </template>\n                    </vue-drag-uploader-item>\n                </slot>\n                \n                <div v-if=\"canUpload\" class=\"vue-drag-uploader__item add-button\" :key=\"'empty'\"\n                    @click=\"clickAdd()\"\n                    :style=\"{ width: thumbSize ? thumbSize + 'px' : null, height: thumbSize ? thumbSize + 'px' : null }\">\n                    <div class=\"add-button__body\">\n                        <div class=\"add-button__icon\">\n                            <span class=\"fa fa-upload fa-2x\"></span>\n                        </div>\n                        <div class=\"add-button__text\">\n                            {{ placeholder }}\n                        </div>\n                    </div>\n                </div>\n            </draggable>\n        </slot>\n    </div>\n</div>\n    `,\n    data() {\n      return {\n        items: [],\n        uploadQueue: {}\n      };\n    },\n    props: {\n      url: String,\n      value: Array,\n      maxFiles: [String, Number],\n      thumbSize: Number,\n      placeholder: String,\n      accept: {\n        type: String,\n        default: ''\n      }\n    },\n    created() {\n      this.value.map(item => {\n        item.key = item.key || this.getKey();\n        item.uploadState = itemStates.COMPLETED;\n      });\n\n      this.items = this.value;\n\n      if (this.maxFiles != null) {\n        if (this.maxFiles < this.items.length) {\n          this.items.splice(this.maxFiles);\n        }\n      }\n    },\n    mounted() {\n      this.$el.addEventListener('dragover', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.add('vue-drag-uploader--ondrag');\n      });\n\n      this.$el.addEventListener('dragleave', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.remove('vue-drag-uploader--ondrag');\n      });\n\n      // File drop\n      this.$el.addEventListener('drop', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.remove('vue-drag-uploader--ondrag');\n\n        const files = event.target.files || event.dataTransfer.files;\n\n        this.uploadFiles(files);\n      });\n    },\n    methods: {\n      clickAdd() {\n        const $input = document.createElement('INPUT');\n        $input.setAttribute('type', 'file');\n        $input.setAttribute('accept', this.accept);\n\n        $input.addEventListener('change', event => {\n          const files = event.target.files || event.dataTransfer.files;\n\n          this.uploadFiles(files);\n        });\n\n        $input.dispatchEvent(new MouseEvent('click', {\n          'view': window,\n          'bubbles': true,\n          'cancelable': true\n        }));\n      },\n\n      getKey() {\n        const date = new Date();\n\n        return date.getTime() + '.' + date.getMilliseconds() + '.' + Math.random();\n      },\n\n      uploadFiles(files) {\n        Array.prototype.forEach.call(files, file => {\n          this.checkFile(file);\n\n          if (!this.canUpload) {\n            return;\n          }\n\n          const reader = new FileReader;\n          const url = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n          const item = {\n            id: '',\n            key: this.getKey(),\n            url: '',\n            thumb_url: url,\n            uploadState: itemStates.NEW,\n            file: file,\n            title: '',\n            alt: '',\n            description: ''\n          };\n\n          this.items.push(item);\n\n          reader.onload = (event) => {\n            const url = event.target.result;\n\n            item.thumb_url = url;\n          };\n\n          reader.readAsDataURL(file);\n        });\n      },\n\n      checkFile(file) {\n        const accepted = this.acceptedTypes;\n        const fileExt = file.name.split('.').pop();\n\n        if (accepted.length) {\n          let allow = false;\n\n          accepted.forEach((type) => {\n            if (allow) {\n              return;\n            }\n\n            if (type.indexOf('/') !== -1) {\n              if (this.compareMimeType(type, file.type)) {\n                allow = true;\n              }\n            } else {\n              if (type === fileExt) {\n                allow = true;\n              }\n            }\n          });\n\n          if (!allow) {\n            swal(\n              Phoenix.__('phoenix.form.field.drag.file.message.unaccepted.files'),\n              Phoenix.__('phoenix.form.field.drag.file.message.unaccepted.files.desc', accepted.join(', ')),\n              'warning'\n            );\n            throw new Error('Not accepted file ext');\n          }\n        }\n      },\n\n      compareMimeType(accepted, mime) {\n        const accepted2 = accepted.split('/');\n        const mime2 = mime.split('/');\n\n        if (accepted2[1] === '*') {\n          return accepted2[0] === mime2[0];\n        }\n\n        return accepted === mime;\n      },\n\n      deleteItem(child) {\n        this.$emit('delete-item', child);\n\n        this.items = this.items.filter(item => item.key !== child.key);\n      },\n\n      uploadStart(uniqid) {\n        Vue.set(this.uploadQueue, uniqid, 0);\n      },\n\n      uploadEnd(uniqid) {\n        Vue.delete(this.uploadQueue, uniqid);\n      },\n\n      uploadProgress(uniqid, progress) {\n        this.uploadQueue[uniqid] = progress;\n      },\n\n      itemClick(item, i, $event) {\n        this.$emit('item-click', item, i, $event);\n      }\n    },\n    watch: {\n      value(val) {\n        val.map(item => {\n          item.key = item.key || this.getKey();\n        });\n\n        this.items = val;\n      },\n\n      items: {\n        handler(items) {\n          this.$emit('change', items);\n        },\n        deep: true\n      },\n\n      uploading(val) {\n        if (val) {\n          this.$emit('uploading');\n        } else {\n          this.$emit('uploaded');\n        }\n      },\n    },\n    computed: {\n      canUpload() {\n        return this.maxFiles == null || this.items.length < this.maxFiles;\n      },\n\n      uploading() {\n        Object.keys(this.uploadQueue);\n        return Object.keys(this.uploadQueue).length > 0;\n      },\n\n      acceptedTypes() {\n        return (Array.isArray(this.accept) ? this.accept : this.accept.split(','))\n          .map(v => v.trim())\n          .filter(v => v.length > 0)\n          .map(v => {\n            if (v.indexOf('/') === -1 && v[0] === '.') {\n              return v.substr(1);\n            }\n\n            return v;\n          });\n      }\n    }\n  };\n\n  Vue.component('vue-drag-uploader', VueDragUploader);\n})();\n"],"file":"vue-drag-uploader.js"}