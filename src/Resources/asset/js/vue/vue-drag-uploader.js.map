{"version":3,"sources":["vue/vue-drag-uploader.js"],"names":["itemStates","NEW","UPLOADING","COMPLETED","FAIL","STOP","VueDragUploaderItem","template","data","state","progress","messages","error","props","item","Object","i","Number","initState","String","uploadUrl","size","created","mounted","upload","methods","uniqid","Date","valueOf","formData","FormData","append","file","$emit","$","post","url","contentType","processData","xhr","XMLHttpRequest","addEventListener","e","lengthComputable","loaded","total","done","res","thumb_url","fail","console","warn","responseJSON","message","always","deleteSelf","watch","VueDragUploader","components","items","uploadQueue","images","Array","maxFiles","thumbSize","placeholder","map","image","key","getKey","uploadState","length","splice","$el","event","stopPropagation","preventDefault","currentTarget","classList","add","remove","files","target","dataTransfer","uploadFiles","clickAdd","$input","document","createElement","setAttribute","dispatchEvent","MouseEvent","window","date","getTime","getMilliseconds","Math","random","prototype","forEach","call","checkFile","canUpload","reader","FileReader","id","title","alt","description","push","onload","result","readAsDataURL","types","indexOf","type","deleteItem","child","filter","uploadStart","Vue","set","uploadEnd","delete","uploadProgress","itemClick","$event","handler","deep","uploading","val","computed","keys","component"],"mappings":"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","sourcesContent":["/**\n * Part of ke project.\n *\n * @copyright  Copyright (C) 2018 ${ORGANIZATION}.\n * @license    __LICENSE__\n */\n\n(() => {\n  const itemStates = {\n    NEW: 'new',\n    UPLOADING: 'uploading',\n    COMPLETED: 'completed',\n    FAIL: 'fail',\n    STOP: 'stop',\n  };\n\n  const VueDragUploaderItem = {\n    template: `\n<div class=\"vue-drag-uploader__item preview-img\"\n    :style=\"{ width: size ? size + 'px' : null, height: size ? size + 'px' : null }\"\n    @click=\"$emit('click', item, i, $event)\">\n    <slot name=\"item\" :item=\"item\">\n        <div class=\"preview-img__body\"\n            :style=\"{'background-image': 'url(' + (item.thumb_url || item.url) + ')'}\"></div>\n\n        <div class=\"preview-img__overlay\">\n          <span class=\"preview-img__remove-icon fa fa-times\"\n              @click.stop.prevent=\"deleteSelf()\"></span>\n          <slot name=\"extra\" :item=\"item\"></slot>\n        </div>\n\n        <div class=\"preview-img__progress\" v-if=\"state === 'uploading'\">\n            <div class=\"preview-img__progress-bar\"\n                :style=\"{width: (progress * 100) + '%'}\"\n            ></div>\n        </div>\n        <div class=\"preview-img__error-message error-message\" v-if=\"state === 'fail'\" @click.stop.prevent=\"\">\n            <span class=\"error-message__notice\">Upload fail</span>\n            <span class=\"error-message__message\">{{ messages.error }}</span>\n        </div>\n    </slot>\n</div>\n    `,\n    data() {\n      return {\n        state: itemStates.COMPLETED,\n        progress: 0,\n        messages: {\n          error: ''\n        }\n      }\n    },\n    props: {\n      item: Object,\n      i: Number,\n      initState: String,\n      uploadUrl: String,\n      size: Number\n    },\n    created() {\n      this.state = this.initState;\n\n      if (this.initState === itemStates.NEW) {\n\n      }\n    },\n    mounted() {\n      if (this.initState === itemStates.NEW) {\n        this.upload();\n      }\n    },\n    methods: {\n      upload() {\n        this.state = itemStates.UPLOADING;\n\n        const uniqid = new Date().valueOf();\n        const formData = new FormData();\n        formData.append('file', this.item.file);\n\n        this.$emit('upload-start', uniqid);\n\n        return $.post({\n            url: this.uploadUrl,\n            data: formData,\n            contentType: false,\n            processData: false,\n            xhr: () => {\n              const xhr = new XMLHttpRequest();\n\n              if(xhr.upload){\n                xhr.upload.addEventListener('progress', e => {\n                  if (e.lengthComputable) {\n                    this.progress = e.loaded / e.total;\n                    this.$emit('upload-progress', uniqid, this.progress);\n                  }\n                }, false);\n              }\n\n              return xhr;\n            },\n        })\n          .done(res => {\n            this.state = itemStates.COMPLETED;\n            this.item.url = res.data.url;\n            this.item.thumb_url = res.data.thumb_url || res.data.url;\n          })\n          .fail(xhr => {\n            console.warn(xhr.responseJSON.message, xhr);\n            this.state = itemStates.FAIL;\n            this.messages.error = xhr.responseJSON.message;\n          })\n          .always(() => {\n            this.item.file = null;\n\n            this.$emit('upload-end', uniqid);\n          });\n      },\n\n      deleteSelf() {\n        this.$emit('delete', this.item);\n      }\n    },\n    watch: {\n    }\n  };\n\n  const VueDragUploader = {\n    components: {\n      'vue-drag-uploader-item': VueDragUploaderItem\n    },\n    template: `\n<div class=\"vue-drag-uploader\">\n    <div class=\"vue-drag-uploader__wrapper\">\n        <slot name=\"items\" \n            :items=\"items\"\n            :url=\"url\"\n            :max-files=\"maxFiles\"\n            :files-limited=\"maxFiles\"\n        >\n            <draggable v-model=\"items\" class=\"vue-drag-uploader__draggable-wrapper\" \n                :options=\"{draggable: '.preview-img', animation: 300}\">\n                <slot name=\"items\" :item=\"items\">\n                    <vue-drag-uploader-item\n                        v-for=\"(item, i) of items\"\n                        :item=\"item\"\n                        :i=\"i\"\n                        :init-state=\"item.uploadState\"\n                        :key=\"item.key\"\n                        :upload-url=\"url\"\n                        :size=\"thumbSize\"\n                        @delete=\"deleteItem\"\n                        @upload-start=\"uploadStart\"\n                        @upload-end=\"uploadEnd\"\n                        @upload-progress=\"uploadProgress\"\n                        @click=\"itemClick\"\n                        >\n                        <template slot=\"item\">\n                            <slot name=\"item\" \n                                :item=\"item\" \n                                :i=\"i\" \n                                :url=\"url\"\n                                :max-files=\"maxFiles\"\n                                :thumb-size=\"thumbSize\"\n                                :files-limited=\"maxFiles\"></slot>\n                        </template>\n                        <template slot=\"extra\">\n                            <slot name=\"extra\" \n                                :item=\"item\" \n                                :i=\"i\" \n                                :url=\"url\"\n                                :max-files=\"maxFiles\"\n                                :thumb-size=\"thumbSize\"\n                                :files-limited=\"maxFiles\"></slot>\n                        </template>\n                    </vue-drag-uploader-item>\n                </slot>\n                \n                <div v-if=\"canUpload\" class=\"vue-drag-uploader__item add-button\" :key=\"'empty'\"\n                    @click=\"clickAdd()\"\n                    :style=\"{ width: thumbSize ? thumbSize + 'px' : null, height: thumbSize ? thumbSize + 'px' : null }\">\n                    <div class=\"add-button__body\">\n                        <div class=\"add-button__icon\">\n                            <span class=\"fa fa-upload fa-2x\"></span>\n                        </div>\n                        <div class=\"add-button__text\">\n                            {{ placeholder }}\n                        </div>\n                    </div>\n                </div>\n            </draggable>\n        </slot>\n    </div>\n</div>\n    `,\n    data() {\n      return {\n        items: [],\n        uploadQueue: {}\n      }\n    },\n    props: {\n      url: String,\n      images: Array,\n      maxFiles: [String, Number],\n      thumbSize: Number,\n      placeholder: String\n    },\n    created() {\n      this.images.map(image => {\n        image.key = image.key || this.getKey();\n        image.uploadState = itemStates.COMPLETED;\n      });\n\n      this.items = this.images;\n\n      if (this.maxFiles != null) {\n        if (this.maxFiles < this.items.length) {\n          this.items.splice(this.maxFiles);\n        }\n      }\n    },\n    mounted() {\n      this.$el.addEventListener('dragover', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.add('vue-drag-uploader--ondrag');\n      });\n\n      this.$el.addEventListener('dragleave', event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.remove('vue-drag-uploader--ondrag');\n      });\n\n      // File drop\n      this.$el.addEventListener(\"drop\", event => {\n        event.stopPropagation();\n        event.preventDefault();\n\n        event.currentTarget.classList.remove('vue-drag-uploader--ondrag');\n\n        const files = event.target.files || event.dataTransfer.files;\n\n        this.uploadFiles(files);\n      });\n    },\n    methods: {\n      clickAdd() {\n        const $input = document.createElement(\"INPUT\");\n        $input.setAttribute('type', 'file');\n\n        $input.addEventListener('change', event => {\n          const files = event.target.files || event.dataTransfer.files;\n\n          this.uploadFiles(files);\n        });\n\n        $input.dispatchEvent(new MouseEvent('click', {\n          'view': window,\n          'bubbles': true,\n          'cancelable': true\n        }));\n      },\n\n      getKey() {\n        const date = new Date();\n\n        return date.getTime() + '.' + date.getMilliseconds() + '.' + Math.random();\n      },\n\n      uploadFiles(files) {\n        Array.prototype.forEach.call(files, file => {\n          if (!this.checkFile(file)) {\n            return;\n          }\n\n          if (!this.canUpload) {\n            return;\n          }\n\n          const reader = new FileReader;\n          const url = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n          const item = {\n            id: '',\n            key: this.getKey(),\n            url: '',\n            thumb_url: url,\n            uploadState: itemStates.NEW,\n            file: file,\n            title: '',\n            alt: '',\n            description: ''\n          };\n\n          this.items.push(item);\n\n          reader.onload = (event) => {\n            const url = event.target.result;\n\n            item.thumb_url = url;\n          };\n\n          reader.readAsDataURL(file);\n        });\n      },\n\n      checkFile: function(file) {\n        const types = [\n          'image/jpeg',\n          'image/png',\n          'image/gif'\n        ];\n\n        return types.indexOf(file.type) !== -1;\n      },\n\n      deleteItem(child) {\n        this.$emit('delete-item', child);\n\n        this.items = this.items.filter(item => item.key !== child.key);\n      },\n\n      uploadStart(uniqid) {\n        Vue.set(this.uploadQueue, uniqid, 0);\n      },\n\n      uploadEnd(uniqid) {\n        Vue.delete(this.uploadQueue, uniqid);\n      },\n\n      uploadProgress(uniqid, progress) {\n        this.uploadQueue[uniqid] = progress;\n      },\n\n      itemClick(item, i, $event) {\n        this.$emit('item-click', item, i, $event);\n      }\n    },\n    watch: {\n      images(images) {\n        images.map(image => {\n          image.key = image.key || this.getKey();\n        });\n\n        this.items = images;\n      },\n\n      items: {\n        handler(items) {\n          this.$emit('change', items);\n        },\n        deep: true\n      },\n\n      uploading(val) {\n        if (val) {\n          this.$emit('uploading');\n        } else {\n          this.$emit('uploaded');\n        }\n      }\n    },\n    computed: {\n      canUpload() {\n        return this.maxFiles == null || this.items.length < this.maxFiles;\n      },\n\n      uploading() {\n        Object.keys(this.uploadQueue);\n        return Object.keys(this.uploadQueue).length > 0;\n      }\n    }\n  };\n\n  Vue.component('vue-drag-uploader', VueDragUploader);\n})();\n"],"file":"vue-drag-uploader.js"}